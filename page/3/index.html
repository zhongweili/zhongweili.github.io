<!doctype html>



  


<html class="theme-next pisces use-motion">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="Jiwzdvse31x2sq3SDlXaAmbUedHiGWiDHQf73GTVCzg">




  <meta name="baidu-site-verification" content="mxzMEaR2p3">







  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  




<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1">






<meta property="og:type" content="website">
<meta property="og:title" content="Zhongwei&#39;s blog">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Zhongwei&#39;s blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Zhongwei&#39;s blog">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: undefined,
      author: '博主'
    }
  };
</script>

  <title> Zhongwei's blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?efa31440ffb097665a64e329b192d121";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <script type="text/javascript">
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId=55772266";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Zhongwei's blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Notes and Random Thoughts</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-question-circle fa-fw"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-guestbook">
          <a href="/guestbook" rel="section">
            
              <i class="menu-item-icon fa fa-heartbeat fa-fw"></i> <br>
            
            留言
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/xiao-zhuan/" itemprop="url">
                  我悠悠醒转
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-12-31T23:30:43+08:00" content="2017-12-31">
              2017-12-31
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一"><a href="#一" class="headerlink" title="一"></a>一</h3><p>在一片皑皑白雪中，时间来到2242年，我悠悠醒转，仿佛是做了一个长长的梦，而梦到了什么却全然记不得。只见周围人慢慢睁开迷蒙的双眼，茫然顾盼左右，全都不知道怎么回事。</p>
<p>后来，少男少女们说出了真相：2042年，人类遭遇了一场浩劫，气候突变，烈日灼灼，地球的环境不再适宜人类，所有人使用了“脱水”技法，化为一片干枯叶子，沉沉睡去；等到200年后，地球再次变寒，人类终于吸水膨胀活了过来，然而，所有人干瘪的“叶子”容量有限，最多存储25年记忆，没有例外。·</p>
<p>于是出现一个奇观，记忆在所有人脑中只剩下从出生到25岁的一段，不论壮硕的中年人还是颤巍巍的老者。每个人都像是一个跌落悬崖的幸存者，努力回忆着生命中七零八落的片段，试图从中找出点点火花。</p>
<h3 id="二"><a href="#二" class="headerlink" title="二"></a>二</h3><p>我快速数了数，灾难日之时自己是50岁，而我的记忆折半，在迷茫的25岁那年戛然而止。一阵寒风吹过，我打了个喷嚏，本能地抱紧双臂，一丝不挂，在这白茫茫的世间，我一无所有，一切功名、钱财、声望都不存在，即使存在过我也记不得，唯一拥有的就是那25年记忆。我不禁想问自己，那25年，我快乐吗？</p>
<p>生命的钟表重回到零，我仔细拨动着指针，不想错过任何记忆的细节，可我看到最多的是一个婴儿在哭泣。幼时多病，从出生起就被打针吃药缠上，那个男婴总是哇哇大哭，父母进城安家立业，但无法带着一个哭不停的累赘，只好把他送到姥姥家。可是没了爹妈孩子岂不是哭得更惨？说也奇怪，那孩子任凭怎么哄就只是哭，唯有迎着风动起来才能止住，于是姥姥姥爷轮流背着孩子跑啊跑，那年头，可把两个老人累弯了腰，跑坏了腿。终于，男孩能自己下地跑了，跑在杏花遍野的山里，跑在松柏护卫的路上，他心底的叶子慢慢舒展开来。就这样面无表情地跑着，男孩不再哭泣。直到有一天，姥爷教他认字，男孩用小小的手指攥紧粉笔，在院子里地面上一笔一划认认真真地写字。写呀写写到夕阳西下余晖满天，男孩抬起头来，望着满满一地的白色粉笔字迹，我终于看到一张快乐的笑脸。</p>
<p>回忆的指针转得更快了，男孩幸运地来到城市念书求学，逃离了深山里那个美到窒息的杏花村。也许是幼年把泪水哭了干涸，那个爱哭鼻子的男孩变成了永远挂着笑脸的少年。同学老师换了一拨又一拨，少年逢人便是眼睛眯成一条缝的笑脸，他是太善良了。父母和老师把少年层层保护起来，让他对周围产生一种稚嫩的美好执念，他跳进无底学海中完全隔绝开外界的浑浊，少年带着那张笑脸成了个学习好的乖孩子。直到同学一句话把他叫醒，“你怎么就知道傻笑呢？”少年呆滞了，他除了傻笑和学习还会什么？不谙世事的少年什么都不会，他太无知了，不知晓人情世故，不懂得悲伤、狂妄、苦闷……青春正好的年纪，行走在独木桥上的少年猛然间开窍，他心底的叶子第一次有了色泽。少年想，他该有所追求。</p>
<h3 id="三"><a href="#三" class="headerlink" title="三"></a>三</h3><p>追求？我细细琢磨着这个词。无法记起自己后一半生命为着什么追求，我只想知道觉醒的少年当初是在追求什么。</p>
<p>然而我再怎么努力，也回忆不起来最初的梦想。少年远离家乡，在大学迷失了自我，大城市的喧嚣盖住了少年的梦。他有太多未曾见过的物件，太多未曾体验的感觉，太多未曾察觉的人情。看到游戏好玩，少年一头扎了进去；听说社团有趣，少年傻乎乎跟着进去忙活；大学生创业风潮袭来，少年也去寻找风口。在随波逐流中庸庸碌碌，最终一无是处。少年大惑，不止一次问自己，“我真正想要的是什么？”</p>
<p>我真正想要的是什么？此时再次想起这个问题，我依然没有答案。我在天命之年醒来，却对自己的命运毫无知晓，我迫切地想要知道，命运的灯塔将25岁那年迷茫无助的我指向了何方。</p>
<p>越来越多人醒来，团团围坐在篝火边，互相交换着彼此的记忆。渐渐地，人们把记忆碎片拼出了模糊的真相，纷纷低声嗟叹，原来之后的世界成了那个样子……</p>
<h3 id="四"><a href="#四" class="headerlink" title="四"></a>四</h3><p>过了一段时间，人们再次默默检视自己唯一的财富——25年的珍贵记忆，在那段时光中，我最宝贵的东西是什么？我与世界是怎样的联系？世界又是如何变了模样？</p>
<p>记忆在我脑海中不再是表盘，而是流水，时而迸溅出些许水花。我最宝贵的东西，是善吗？那个善良的少年，永远真诚待人，好像什么都不图，又好像一早就知道善良的好处，哪怕是伪善，假装做个乖孩子，赢得老师爱戴，榨取父母信任，即使撒谎、偷盗、作弊，也不会被怀疑。少年一点点明白了弱肉强食的丛林规则，明白了利益为先的永恒法则，悄无声息滑向了另一头，他一边耗损着纯洁的善良心地，一边对着这世界扮出贪婪而狰狞的鬼脸。</p>
<p>是真吗？少年曾经以追求真理为荣，以发现真相为标，旺盛的好奇心驱使他对身边的一切探个究竟，他曾废寝忘食钻研题目，哪怕被人唤作呆子，仍是沉浸在自己的世界冥思苦想。可是他越是探得深入，越发感到冰冷，这世界原来不是他想的那样。少年在现实生活中见识了太多残酷和功利，他转向网络世界，又窥见了更多暗网深渊、人性欲望。少年变得冷酷而敏感，不再问对错只看利弊，不在乎感情只关心逻辑，看起来那么“理性”。最心爱的人对他说，“你有讲不完的道理，可你的道理太伤人。”女孩离他而去。</p>
<h3 id="五"><a href="#五" class="headerlink" title="五"></a>五</h3><p>我恍然大悟。成长岁月里，我竟然把我最宝贵的东西——真和善，一点一点抛弃掉了。一辈子，我会遇到的功利计算太多太多，我变得更加成熟，更加理智，我告别了山村，告别了灯塔，直到最终会告别我自己。</p>
<p>命运的齿轮嗤嗤作响，我慢慢变得复杂，正如人类愈加膨胀、愈加功利，而世界拖着愈加笨重的身躯转不过弯。</p>
<p>此刻我所有的记忆如泉水般汩汩涌出，我依稀看到了，后25年，人类发展科技的雄心背后，是穷兵黩武和利益熏心的自大狂，贪婪和奸诈，凶恶和残忍，轮番上演，无尽的欲望终至世界混乱，末日降临……</p>
<p>还好，200年后，世界依旧如故。在一片皑皑白雪中，人类有机会反思自我，找回丢失的真和善，重建美丽家园。在25年记忆承载下，每个人也都有机会重建人生，找回自己心底的叶子。</p>
<p>我的问题也有了答案。快乐或不快乐，不在于微笑或哭泣，只有内心知道。当围棋不再功利，才有夜凉吹笛千山月的乐趣。我所追求的，当是无用之用的美。</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      


      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/HTTPS/" itemprop="url">
                  HTTPS 由来
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-11-19T09:48:52+08:00" content="2017-11-19">
              2017-11-19
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>网络世界纷繁复杂，绝大部分信息传输都仰仗 HTTP 协议。每次访问一个网页，就像是在外卖 App 上下单，商户将食物打包，再由外卖小哥接单送达用户，数不胜数的订单同时进去，这背后早有 HTTP 协议支持，不会送错。</p>
<p>HTTP 使得信息有条不紊传输下去，但无法保障互联网中的安全，信息在传输时可能被劫持篡改。想象一下，外卖小哥在送餐途中遭遇到歹徒拦截，抢走了盒饭或者掉包了食物，用户当然不会满意。不同的是，互联网世界里没有警察，歹徒可以随意抢劫，谁叫餐盒暴露在外呢？</p>
<p>还好，互联网世界物品成本极低，设计师可以花些心思改良 HTTP 协议，他先在餐盒上加了保险箱，遇上歹徒也能保证食物安全，这就是信息加密。不过，用户同样无法打开保险箱，商家和用户还需要有一把彼此认同的钥匙。显然送钥匙这个过程难免被劫，这还无法确保万无一失。</p>
<p>设计师开动脑筋，发明了一种特殊保险箱，箱子上的锁需要两把钥匙控制，一把叫公钥用于加锁，一把叫私钥用于解锁。商家先把公钥发给用户，即使被劫也无用，公钥只能加锁无法解锁，用户拿到公钥后将钥匙加锁发给商家，歹徒拦住也打不开锁，商家再用私钥开锁取出里面的钥匙，接下来就可以用保险箱送东西了。这便是信息的非对称加密。</p>
<p>这个方法看似高明，却依然无法躲开聪明歹徒。歹徒先在途中劫下公钥，换成自己制作的假公钥发给用户，待假公钥加锁的钥匙传来时再劫下来，歹徒当然有假私钥，轻松破解。这个手段在密码学中称为中间人攻击。</p>
<p>这下商家生气了，花钱去安保公司请了保安，用保安护送公钥给用户，总算安全了。歹徒眼珠一转计上心头，他找来假保安带着假公钥捷足先登拜访用户。不过安保公司有一套完整的身份验证机制，每一个保安都有证明自己身份的工作证——数字证书。</p>
<p>证书难道无法伪造吗？使用了安保公司的公钥进行验证，这种数字证书绝对真实。安保公司的公钥又是怎么到用户手里呢？答案是每个用户家里都有一份公钥，因为安保公司只有那么几家，他们事先发给了所有用户。在计算机中，所有操作系统和浏览器都维护一个权威第三方机构公钥列表。</p>
<p>终于，这种复杂机制杜绝了歹徒劫持，设计师称之为 SSL 协议。HTTP + SSL 便是 HTTPS。</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      


      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/go-interface/" itemprop="url">
                  Go 语言中的接口
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-11-18T23:36:48+08:00" content="2017-11-18">
              2017-11-18
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Go 语言中设计最精妙的部分是 interface。</p>
<p>有人甚至将 interface 翻译为“界面”而非“接口”，可见 Go 语言中的接口独树一帜，与 C++ 颇不一样。</p>
<h3 id="一"><a href="#一" class="headerlink" title="一"></a>一</h3><p>据说，Go语言的诞生，是三个有很强个性的设计师共同完成的。Go语言的定位，就象三维坐标系中的一个点，在强类型、动态和并发这三个特性维度上，分别代表了Ken、Robert和Rob三人的创造思维的投影。</p>
<p>与 C++、Java 一样，Go 的变量类型是安全高效的强静态类型，“强类型”这一点容易理解；“并发”是 Go 的一大特性以后再说；何来“动态”呢？在 Python、Ruby 这类动态语言中有动态类型，对象可以根据提供的方法被处理，而忽略它们的实际类型，Go 也有这种功力吗？</p>
<p>《Go 语言中的面向对象》一文中讲过，Go 没有明显的继承，而是用 Has-A 替代 Is-A 的实现的。</p>
<blockquote>
<p>如果一只鸟走起来像鸭子，叫起来像鸭子，那它就是鸭子 。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> IDuck <span class="keyword">interface</span> &#123;</span><br><span class="line">    Quack()</span><br><span class="line">    Walk()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DuckDance</span><span class="params">(duck IDuck)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++ &#123;</span><br><span class="line">        duck.Quack()</span><br><span class="line">        duck.Walk()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Bird <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *Bird)</span> <span class="title">Quack</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"I am quacking!"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *Bird)</span> <span class="title">Walk</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    fmt.Println(<span class="string">"I am walking!"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    b := <span class="built_in">new</span>(Bird)</span><br><span class="line">    DuckDance(b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>遵循这个理念，Go 使用接口规避了传统面向对象的继承（似乎传统继承有不少缺点，关于继承和组合有颇多讨论），使得这种静态语言表现出非常灵活的动态性。</p>
<h3 id="二"><a href="#二" class="headerlink" title="二"></a>二</h3><p>具体来看，接口是一组 method 签名的组合，我们通过接口来定义对象的一组行动。比较方便的是，任何提供了接口方法实现代码的类型都隐式地实现了该接口，而不用显式地声明。同时，任何类型都实现了空接口（interface{}），因为空接口不包含任何 method。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义a为空接口</span></span><br><span class="line"><span class="keyword">var</span> a <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">5</span></span><br><span class="line">s := <span class="string">"Hello world"</span></span><br><span class="line"><span class="comment">// a可以存储任意类型的数值</span></span><br><span class="line">a = i</span><br><span class="line">a = s</span><br></pre></td></tr></table></figure>
<p>顺着这个思路，如果一个函数把interface{}作为参数，那么他可以接受任意类型的值作为参数，如果一个函数返回interface{},那么也就可以返回任意类型的值。</p>
<p>当然，非空接口也可作为函数参数，试看一例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"strconv"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Human <span class="keyword">struct</span> &#123;</span><br><span class="line">    name <span class="keyword">string</span></span><br><span class="line">    age <span class="keyword">int</span></span><br><span class="line">    phone <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过这个方法 Human 实现了 fmt.Stringer</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h Human)</span> <span class="title">String</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"❰"</span>+h.name+<span class="string">" - "</span>+strconv.Itoa(h.age)+<span class="string">" years -  ✆ "</span> +h.phone+<span class="string">"❱"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    Bob := Human&#123;<span class="string">"Bob"</span>, <span class="number">39</span>, <span class="string">"000-7777-XXX"</span>&#125;</span><br><span class="line">    fmt.Println(<span class="string">"This Human is : "</span>, Bob)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>fmt.Println 可以直接输出 Bob，这是因为 Bob 实现了 String() 也就实现了接口 fmt.Stringer</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Stringer <span class="keyword">interface</span> &#123;</span><br><span class="line">     String() <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>而 fmt.Println 的函数参数正是 Stringer 接口！</p>
<h3 id="三"><a href="#三" class="headerlink" title="三"></a>三</h3><p>不仅如此，Go 的接口还有一个吸引人的地方，它支持匿名字段。就像 struct 的匿名字段一样，带有匿名字段的接口竟包含了另一个接口，那么这个接口同时包含了另一个接口的方法！看源码会发现有大量这样的例子，比如</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// io.ReadWriter</span></span><br><span class="line"><span class="keyword">type</span> ReadWriter <span class="keyword">interface</span> &#123;</span><br><span class="line">  Reader</span><br><span class="line">  Writer</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>io 包下面的 io.ReadWriter 包含了 io 包里的 Reader 和 Writer 两个接口。我们发现，这种嵌入接口的机制使得语言又灵活了不少。</p>
<p>在灵活的同时，Go 还能保证减少编译出错，因为我们可以反向知道接口变量里实际保存了哪些类型，这便是 Go 的 Comma-ok 断言和 switch 测试。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> index, element := <span class="keyword">range</span> list &#123;</span><br><span class="line">          <span class="keyword">if</span> value, ok := element.(<span class="keyword">int</span>); ok &#123;</span><br><span class="line">              fmt.Printf(<span class="string">"list[%d] is an int and its value is %d\n"</span>, index, value)</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> value, ok := element.(<span class="keyword">string</span>); ok &#123;</span><br><span class="line">              fmt.Printf(<span class="string">"list[%d] is a string and its value is %s\n"</span>, index, value)</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> value, ok := element.(Person); ok &#123;</span><br><span class="line">              fmt.Printf(<span class="string">"list[%d] is a Person and its value is %s\n"</span>, index, value)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              fmt.Printf(<span class="string">"list[%d] is of a different type\n"</span>, index)</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index, element := <span class="keyword">range</span> list&#123;</span><br><span class="line">          <span class="keyword">switch</span> value := element.(<span class="keyword">type</span>) &#123;</span><br><span class="line">              <span class="keyword">case</span> <span class="keyword">int</span>:</span><br><span class="line">                  fmt.Printf(<span class="string">"list[%d] is an int and its value is %d\n"</span>, index, value)</span><br><span class="line">              <span class="keyword">case</span> <span class="keyword">string</span>:</span><br><span class="line">                  fmt.Printf(<span class="string">"list[%d] is a string and its value is %s\n"</span>, index, value)</span><br><span class="line">              <span class="keyword">case</span> Person:</span><br><span class="line">                  fmt.Printf(<span class="string">"list[%d] is a Person and its value is %s\n"</span>, index, value)</span><br><span class="line">              <span class="keyword">default</span>:</span><br><span class="line">                  fmt.Println(<span class="string">"list[%d] is of a different type"</span>, index)</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<p>并且，Go 语言有反射机制，可以检查程序在运行时的状态。这简直是在说，一个聪明灵活的人，还非常善于反省。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">show</span><span class="params">(i <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> t:= i.(<span class="keyword">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> *Person:</span><br><span class="line">    	t := reflect.TypeOf(i)</span><br><span class="line">    	v := reflect.ValueOf(i)</span><br><span class="line">    	tag := t.Elem().Field(<span class="number">0</span>).Tag</span><br><span class="line">    	name := t.Elem().Field(<span class="number">0</span>).String()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      


      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/go-object/" itemprop="url">
                  Go 语言中的面向对象
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-11-15T12:13:12+08:00" content="2017-11-15">
              2017-11-15
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>一切皆是对象。</p>
</blockquote>
<p>这在 Java 这种强面向对象语言中是一条铁律。然而什么是对象，为什么一切都是对象？初学者很难理解。</p>
<p>在 Java、C++ 这些语言中，实现面向对象的基础设施叫做类。类是对象的抽象，对象是类的具体。本着这样的原则，面向对象的三特性封装、继承、多态拔地而起，浑然天成。Go 语言中的设计却在多个方面有所差异，有些甚至理念迥异，剖析一下这些设计，或许能引发面向对象的更多思考。</p>
<p>Java 和 C++ 中，类是一个对象生成器，是语言的根基，连类型都是通过类定义的。变量和方法全部封装在 class 中，追求彻底的面向对象。</p>
<p>而在 Go 中没有 class，取而代之的是 type。有趣的是，变量和方法是分开的，没有全部包含在类型中。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Circle <span class="keyword">struct</span> &#123;</span><br><span class="line">  radius <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Circle)</span> <span class="title">area</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">  <span class="keyword">return</span> c.radius*c.radius*math.Pi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样的处理方式似乎更加灵活一些，不必一开始就把类中的所有东西定义好，而是不断增加新的方法，使得程序更容易扩展。</p>
<p>Go 中的 type 相当灵活，不仅可以定义 struct，还可以在基础类型之上定义新的类型。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> color <span class="keyword">byte</span></span><br><span class="line"><span class="keyword">type</span> Box <span class="keyword">struct</span> &#123;</span><br><span class="line">  width, height, depth <span class="keyword">float64</span></span><br><span class="line">  color Color</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> BoxList []Box</span><br></pre></td></tr></table></figure>
<p>这样的自定义类型随意组合，可以丰富描述问题的方式。</p>
<p>Go 中个方法也比较特殊，分为 func 和 method 两种。func 是通常意义上的函数，method 则是配合 type 的方法。method 在定义时会指定一个 type，但不从属于 type，只是单独存在于 type 外围。这便是 type 的扩展。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Rectangle <span class="keyword">struct</span> &#123;</span><br><span class="line">    width, height <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">area</span><span class="params">(r Rectangle)</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> r.width*r.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r Rectangle)</span> <span class="title">area</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">  	<span class="keyword">return</span> r.width*r.height</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>了解了这些，再来看面向对象的三大特性。</p>
<h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><p>将对象的状态信息(eg:Person 对象的 age 变量)隐藏在对象内部，外部程序只能通过该类提供的方法来实现对内部信息的操作和访问。Go 中就是通过 type 和 method 实现的。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"math"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Rectangle <span class="keyword">struct</span> &#123;</span><br><span class="line">    width, height <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Circle <span class="keyword">struct</span> &#123;</span><br><span class="line">    radius <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r Rectangle)</span> <span class="title">area</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> r.width*r.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Circle)</span> <span class="title">area</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> c.radius * c.radius * math.Pi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r1 := Rectangle&#123;<span class="number">12</span>, <span class="number">2</span>&#125;</span><br><span class="line">    r2 := Rectangle&#123;<span class="number">9</span>, <span class="number">4</span>&#125;</span><br><span class="line">    c1 := Circle&#123;<span class="number">10</span>&#125;</span><br><span class="line">    c2 := Circle&#123;<span class="number">25</span>&#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">"Area of r1 is: "</span>, r1.area())</span><br><span class="line">    fmt.Println(<span class="string">"Area of r2 is: "</span>, r2.area())</span><br><span class="line">    fmt.Println(<span class="string">"Area of c1 is: "</span>, c1.area())</span><br><span class="line">    fmt.Println(<span class="string">"Area of c2 is: "</span>, c2.area())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>继承就是子类继承父类的特征和行为，使得子类具有父类的各种属性和方法（重用父类代码）。Go 中的继承则没有继承关系链，子类和父类是完全不同的类型，还能重用父类的方法和成员。这得益于 Go 中的匿名字段。如果匿名字段实现了一个 method，那么包含这个匿名字段的 struct 也能调用该 method。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Human <span class="keyword">struct</span> &#123;</span><br><span class="line">    name <span class="keyword">string</span></span><br><span class="line">    age <span class="keyword">int</span></span><br><span class="line">    phone <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">    Human <span class="comment">//匿名字段</span></span><br><span class="line">    school <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Employee <span class="keyword">struct</span> &#123;</span><br><span class="line">    Human <span class="comment">//匿名字段</span></span><br><span class="line">    company <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在human上面定义了一个method</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *Human)</span> <span class="title">SayHi</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"Hi, I am %s you can call me on %s\n"</span>, h.name, h.phone)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    mark := Student&#123;Human&#123;<span class="string">"Mark"</span>, <span class="number">25</span>, <span class="string">"222-222-YYYY"</span>&#125;, <span class="string">"MIT"</span>&#125;</span><br><span class="line">    sam := Employee&#123;Human&#123;<span class="string">"Sam"</span>, <span class="number">45</span>, <span class="string">"111-888-XXXX"</span>&#125;, <span class="string">"Golang Inc"</span>&#125;</span><br><span class="line"></span><br><span class="line">    mark.SayHi()</span><br><span class="line">    sam.SayHi()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种设计其实是以 Has-A 替代 了 Is-A 的方式实现。</p>
<h3 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h3><p>相同类型的(引用)变量，调用同一个方法（父类和子类都有的同名方法）时呈现出多种不同的行为特征。Go 中实现起来也很简单的，在上面的例子中，Student 和 Employee 都继承了 Human，再增加一个 Student 的 SayHi 方法，就实现了多态。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Human <span class="keyword">struct</span> &#123;</span><br><span class="line">    name <span class="keyword">string</span></span><br><span class="line">    age <span class="keyword">int</span></span><br><span class="line">    phone <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">    Human <span class="comment">//匿名字段</span></span><br><span class="line">    school <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Employee <span class="keyword">struct</span> &#123;</span><br><span class="line">    Human <span class="comment">//匿名字段</span></span><br><span class="line">    company <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在human上面定义了一个method</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *Human)</span> <span class="title">SayHi</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"Hi, I am %s you can call me on %s\n"</span>, h.name, h.phone)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e *Employee)</span> <span class="title">SayHi</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"Hi, I am %s, I work at %s. Call me on %s\n"</span>, e.name,</span><br><span class="line">        e.company, e.phone)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Student)</span> <span class="title">SayHi</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"Hi, I am %s, I study at %s. Call me on %s\n"</span>, s.name,</span><br><span class="line">        s.school, s.phone)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    mark := Student&#123;Human&#123;<span class="string">"Mark"</span>, <span class="number">25</span>, <span class="string">"222-222-YYYY"</span>&#125;, <span class="string">"MIT"</span>&#125;</span><br><span class="line">    sam := Employee&#123;Human&#123;<span class="string">"Sam"</span>, <span class="number">45</span>, <span class="string">"111-888-XXXX"</span>&#125;, <span class="string">"Golang Inc"</span>&#125;</span><br><span class="line"></span><br><span class="line">   	<span class="keyword">var</span> h human</span><br><span class="line">   	h = &amp;mark</span><br><span class="line">   	h.SayHi()</span><br><span class="line">   	</span><br><span class="line">   	h = &amp;sam</span><br><span class="line">   	h.SayHi()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      


      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/go-package/" itemprop="url">
                  Go 语言的包管理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-11-13T23:56:29+08:00" content="2017-11-13">
              2017-11-13
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="GOPATH"><a href="#GOPATH" class="headerlink" title="GOPATH"></a>GOPATH</h3><p>安装 Go 时配置环境变量除了 GOROOT 还有一个 GOPATH，GOROOT 是 go 的安装路径，那么 GOPATH 是什么呢？</p>
<p>Go 语言提供了一个 Workspace 的机制，GOPATH 指的就是 Go 代码所在的 Workspace 位置。一般来说，这个目录下会有 pkg、src、bin 三个子目录。</p>
<ul>
<li><code>bin</code> 目录用来放置编译好的可执行文件，为了使得这里的可执行文件可以方便的运行， 在 shell 中设置<code>PATH</code>变量。</li>
</ul>
<ul>
<li><code>src</code> 目录用来放置代码源文件，在进行<code>import</code>时，是使用这个位置作为根目录的。自己编写的代码也应该放在这下面。</li>
<li><code>pkg</code> 用来放置安装的包的链接对象(Object)的。这个概念有点类似于链接库，Go 会将编译出的可连接库放在这里， 方便编译时链接。不同的系统和处理器架构的对象会在<code>pkg</code>存放在不同的文件夹中。 </li>
</ul>
<p>另外，很多人推荐设置两个 GOPATH，一个用来存放自己写的代码，另一个放的则是包。</p>
<h3 id="包管理"><a href="#包管理" class="headerlink" title="包管理"></a>包管理</h3><p>何谓包，这就要说到 Go 语言中的包管理机制。在 Go 语言里，包是一个很重要的概念，表示函数和数据的集合，用 package 关键字定义。直观地看，包就是计算机里的目录/文件夹，类似于 java 中的包，能够将文件组织起来，方便归类和复用。Go 语言内置了大量常用的包，比如：</p>
<ul>
<li>fmt。实现了格式化的 I/O 函数。</li>
<li>io。提供了原始的 I/O 操作界面。</li>
<li>sort。提供排序功能。</li>
<li>os。包含平台无关的操作系统功能接口。</li>
<li>sync。提供基本的同步原语。</li>
<li>net/http。实现了 http 相关的大部分功能。</li>
</ul>
<p>Go 语言提供了 import 关键字来导入包，写的路径就是 GOPATH 目录下面。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"github.com/zenazn/goji"</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>除了内置的包，Go 语言可以很方便地使用第三方包，这些大多是在 github.com 和 golang.org 上。</p>
<p>使用 go get 命令可以递归获取到远程仓库的包，并存储在 GOPATH 目录下。</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>Go 在导入包时可以对包进行重命名，这可以避免不同包名称重复的问题。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	myfmt <span class="string">"mylib/fmt"</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>有时候只需要导入一个包而不使用它，可以将包重命名为 _。</p>
<p>包可以有任意个 init 函数，用来在 main 函数执行前进行初始化操作。使用 _ 重命名的包就只会执行 init 函数。</p>
<p>包命声明为 main 时，表示这是一个可执行程序。在 Go 语言里，同时满足 main 包和包含 main() 函数，才会被编译成一个可执行文件。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"Hello, world!"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      


      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/build-a-tree/" itemprop="url">
                  种一棵树
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-11-01T19:14:56+08:00" content="2017-11-01">
              2017-11-01
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>种一棵树，最好的时间是十年前，其次是现在。学编程亦如此。</p>
<p>我决定新学一门编程语言，一方面从零学起可以补漏一些计算机基础知识，另一方面为以后的工作储备，多一点发展方向。</p>
<p>为什么选择学习Go？左耳朵耗子的<a href="https://coolshell.cn/articles/18190.html" target="_blank" rel="noopener">这篇文章</a>讲得很精彩，他以一个前辈的视野论述了Go语言的优缺点和发展前景。</p>
<blockquote>
<p>一个技术能不能发展起来，关键看三点：</p>
<ul>
<li>有没有一个比较好的社区</li>
<li>有没有一个工业化的标准</li>
<li>有没有一个或多个杀手级应用</li>
</ul>
<p>用这些标尺来量一下Go语言，可以清楚看到：</p>
<ul>
<li>Go 语言容易上手</li>
<li>Go 语言解决了并发编程和写底层应用开发效率的痛点</li>
<li>Go 语言有Google这个世界一流的技术公司在后面</li>
<li>Go 语言的杀手级应用是Docker，而Docker的生态圈在这几年完全爆棚了</li>
</ul>
</blockquote>
<p>好了，话不多说，本文记录一下Go环境配置。</p>
<h4 id="Go安装"><a href="#Go安装" class="headerlink" title="Go安装"></a>Go安装</h4><h5 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h5><p>win10系统直接官网下载安装，环境变量都自动配置好了</p>
<h5 id="Linux（CentOS）"><a href="#Linux（CentOS）" class="headerlink" title="Linux（CentOS）"></a>Linux（CentOS）</h5><p>下载</p>
<p><code>wget https://storage.googleapis.com/golang/go1.9.linux-amd64.tar.gz</code></p>
<p>解压</p>
<p><code>tar -C /usr/local -xzf go$VERSION.$OS-$ARCH.tar.gz</code></p>
<p>设置环境变量，~/.bashrc、~/.zshrc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export GOROOT=$HOME/go</span><br><span class="line">export GOPATH=$HOME/work</span><br><span class="line">export PATH=$PATH:GOROOT/bin:$GOPATH/bin</span><br><span class="line">export GOBIN=$HOME/work/bin</span><br></pre></td></tr></table></figure>
<h4 id="Go命令"><a href="#Go命令" class="headerlink" title="Go命令"></a>Go命令</h4><p><code>go build</code></p>
<p>编译</p>
<p><code>go clean</code></p>
<p>清除编译文件</p>
<p><code>go get</code></p>
<p>获取远程包（其实是两步，下载，go install）</p>
<p><code>go install</code></p>
<p>加载（生成可执行结果，并自动放到$GOBIN下）</p>
<p><code>go test</code></p>
<p>读取*_test.go文件，生成并运行测试用可执行文件</p>
<p><code>go run</code></p>
<p>编译并运行Go程序</p>
<h4 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h4><p><code>mkdir $GOPATH/hello</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Printf(<span class="string">"Hello, world.\n"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>go install hello</code></p>
<p><code>hello</code></p>
<p>输出”Hello，world.”</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      


      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Zhongwei">
          <p class="site-author-name" itemprop="name">Zhongwei</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">84</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhongwei</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  



  
  
  

  

  

</body>
</html>

